!function(){"use strict";const e={permissive:["MIT","ISC","BSD-2-Clause","BSD-3-Clause","Apache-2.0","Unlicense","0BSD","CC0-1.0","BSD","Apache","Apache 2.0","Apache License 2.0","MIT License","ISC License"],weakCopyleft:["LGPL-2.1","LGPL-3.0","LGPL-2.0","LGPL","MPL-2.0","MPL-1.1","MPL","EPL-1.0","EPL-2.0","EPL"],strongCopyleft:["GPL-2.0","GPL-3.0","GPL","AGPL-3.0","AGPL","GPL-2.0-only","GPL-3.0-only","GPL-2.0-or-later","GPL-3.0-or-later"]};function n(n){if(!n)return"unknown";const t=n.toUpperCase();for(const[s,i]of Object.entries(e))if(i.some(e=>t.includes(e.toUpperCase())))return s;return"unknown"}const t={none:0,low:1,moderate:2,high:3,critical:4};function s(e){var n;return(null==(n=e.vulnerabilities)?void 0:n.highestSeverity)||"none"}function i(e){if(!e)return"0 B";const n=["B","KB","MB","GB"];let t=e,s=0;for(;t>=1024&&s<n.length-1;)t/=1024,s++;return t.toFixed(t>=10?0:1)+" "+n[s]}function a(e){return e?"Yes":"No"}function r(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""}function o(e){return"imported"===e?"Imported":"not-imported"===e?"Not statically imported":"undeclared"===e?"Imported but not declared":"Unknown"}function l(e,n){return'<div class="indicator"><span class="indicator-dot '+n+'"></span>'+r(e)+"</div>"}function c(e,n,t){let s='<div class="kv-item">';return s+='<span class="kv-label">'+r(e)+"</span>",s+='<span class="kv-value">'+r(String(n))+"</span>",t&&(s+='<span class="kv-hint">'+r(t)+"</span>"),s+="</div>",s}function d(e,n){if(!e||0===e.length)return'<span class="kv-value">None</span>';const t=e.slice(0,n),s=e.length-n;let i='<div class="package-list">';return t.forEach(e=>{i+='<span class="package-tag">'+r(e)+"</span>"}),s>0&&(i+='<span class="package-tag">+'+s+" more</span>"),i+="</div>",i}function u(e,n,t){let s='<div class="section">';return s+='<div class="section-header">',s+='<span class="section-title">'+r(e)+"</span>",n&&(s+='<span class="section-desc">'+r(n)+"</span>"),s+="</div>",s+=t,s+="</div>",s}function p(e,n,t){return u(e,n,'<div class="kv-grid">'+t.join("")+"</div>")}function m(e){const n='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M0 7.334v8h6.666v1.332H12v-1.332h12v-8H0zm6.666 6.664H5.334v-4H3.999v4H1.335V8.667h5.331v5.331zm4 0v1.336H8.001V8.667h5.334v5.332h-2.669v-.001zm12.001 0h-1.33v-4h-1.336v4h-1.335v-4h-1.33v4h-2.671V8.667h8.002v5.331zM10.665 10H12v2.667h-1.335V10z"/></svg>',t='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>',s='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>',i='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>';let a='<div class="package-links">';return a+='<a href="'+r(e.npm)+'" target="_blank" rel="noopener" class="package-link">'+n+"npm</a>",e.repository&&(a+='<a href="'+r(e.repository)+'" target="_blank" rel="noopener" class="package-link">'+t+"Repository</a>"),e.homepage&&(a+='<a href="'+r(e.homepage)+'" target="_blank" rel="noopener" class="package-link">'+i+"Homepage</a>"),e.bugs&&(a+='<a href="'+r(e.bugs)+'" target="_blank" rel="noopener" class="package-link">'+s+"Issues</a>"),a+="</div>",a}function g(e){var t,g;const v=e.license.license||"Unknown",h=n(v),y=function(e){const n=[e.vulnRisk,e.licenseRisk];return n.includes("red")?"red":n.includes("amber")?"amber":"green"}(e),f=s(e),k={permissive:{text:"Permissive",class:"green"},weakCopyleft:{text:"Weak Copyleft",class:"amber"},strongCopyleft:{text:"Strong Copyleft",class:"red"},unknown:{text:"Unknown",class:"gray"}},L=e.direct?"Dependency":"Sub-Dependency",C=[l(L,e.direct?"green":"amber"),'<div class="indicator-separator"></div>',l(e.runtimeClass,"runtime"===e.runtimeClass?"green":"build-time"===e.runtimeClass?"amber":"gray"),'<div class="indicator-separator"></div>',l(v+" ("+k[h].text+")",k[h].class),'<div class="indicator-separator"></div>',l("Vulns: "+f,e.vulnRisk),'<div class="indicator-separator"></div>',l(o(e.usage.status),"undeclared"===e.usage.status?"red":"imported"===e.usage.status?"green":"not-imported"===e.usage.status?"amber":"gray")],b=['<summary class="dep-summary">','<svg class="expand-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>','<span class="dep-name">'+r(e.name)+'<span class="dep-version">@'+r(e.version)+"</span></span>",'<div class="dep-indicators">',C.join(""),"</div>","</summary>"].join(""),S=e.vulnerabilities.items.map(e=>'<tr data-severity="'+e.severity+'"><td>'+r(e.title)+"</td><td>"+r(e.severity)+"</td><td>"+r(e.vulnerableRange||"")+'</td><td><a href="'+r(e.url||"#")+'" target="_blank" rel="noopener">Link</a></td></tr>').join(""),w=e.vulnerabilities.items.length?'<table class="vuln-table"><thead><tr><th>Title</th><th>Severity</th><th>Range</th><th>Ref</th></tr></thead><tbody>'+S+"</tbody></table>":'<p class="no-vulns">No known vulnerabilities.</p>',B=JSON.stringify(e,null,2),E=(e.parents||[]).map(e=>e.split("@")[0]),P=(e.rootCauses||[]).join(", ")||(e.direct?"package.json":"Unknown"),I=p("Overview","Dependency position and runtime classification",[c("Type",L,e.direct?"Listed in package.json":"Installed as a sub-dependency"),c("Depth",e.depth,"How deep this package is in the dependency tree"),c("Parents",E.join(", ")||"None (direct dependency)","Packages that directly depend on this"),c("Installed By",P,"Root dependency in package.json that causes this to be installed"),c("Runtime Class",e.runtimeClass,e.runtimeReason)]),x=p("License","License information for this package",[c("License",v,"The declared license"),c("Category",k[h].text,"Business-friendliness classification"),c("License File",e.license.licenseFile||"Not found","Path to license file if present")]),D=u("Vulnerabilities","Known security issues from npm audit",w),M=u("Maintenance","Package maintenance status",'<div class="kv-grid">'+c("Status",e.maintenance.status,e.maintenance.reason)+(e.maintenance.lastPublished?c("Last Published",e.maintenance.lastPublished,""):"")+"</div>"),j=u("Usage","Static import usage in your codebase",'<div class="kv-grid">'+c("Status",o(e.usage.status),e.usage.reason)+"</div>"),T=p("Identity & Metadata","Package metadata",[c("Deprecated",a(e.identity.deprecated),"Whether the author has deprecated this package"),c("Node Engine",e.identity.nodeEngine||"Any","Required Node.js version"),c("Repository",a(e.identity.hasRepository),"Whether source repo is linked"),c("Funding",a(e.identity.hasFunding),"Whether funding info is provided")]),H=p("Dependency Surface","What this package depends on",[c("Dependencies",e.dependencySurface.dependencies+" prod / "+e.dependencySurface.devDependencies+" dev / "+e.dependencySurface.peerDependencies+" peer / "+e.dependencySurface.optionalDependencies+" optional",""),c("Has Peer Dependencies",a(e.dependencySurface.hasPeerDependencies),"Peer deps can complicate upgrades")]),z=p("Size & Footprint","Disk space usage",[c("Installed Size",i(e.sizeFootprint.installedSize),"Total size on disk"),c("File Count",e.sizeFootprint.fileCount,"Number of files installed")]),N=p("Build & Platform","Build complexity indicators",[c("Native Code",a(e.buildPlatform.nativeBindings),"Requires compilation"),c("Install Scripts",a(e.buildPlatform.installScripts),"Runs code during install")]),R=p("Module System","Module format information",[c("Format",e.moduleSystem.format,"CommonJS, ESM, or dual"),c("Conditional Exports",a(e.moduleSystem.conditionalExports),"Uses exports field")]),A=p("TypeScript","Type definition support",[c("Types","bundled"===e.typescript.types?"Bundled":"None","Whether types are included")]),F=(null==(t=e.graph)?void 0:t.dependedOnBy)||[],G=(null==(g=e.graph)?void 0:g.dependsOn)||[],O=u("Graph Shape","Dependency graph connections",'<div class="kv-grid"><div class="kv-item"><span class="kv-label">Depended On By ('+e.graph.fanIn+")</span>"+d(F,8)+'</div><div class="kv-item"><span class="kv-label">Depends On ('+e.graph.fanOut+")</span>"+d(G,8)+"</div></div>");return['<details class="dep-card" data-risk="'+y+'">',b,'<div class="dep-details">',m(e.links),I,x,D,M,j,T,H,z,N,R,A,O,'<details class="raw-data-toggle"><summary>View raw data</summary><pre>'+r(B)+"</pre></details>","</div>","</details>"].join("")}async function v(){var e,i;const a=await async function(){const e=document.getElementById("radar-data");return e&&e.textContent&&"{}"!==e.textContent.trim()?JSON.parse(e.textContent):(await fetch("./sample-data.json")).json()}(),o=document.getElementById("dependency-list"),l=document.getElementById("results-summary"),c=document.getElementById("project-path");c&&(c.textContent=a.projectPath);const d=document.getElementById("git-branch-br"),u=document.getElementById("git-branch-text");a.gitBranch&&u?u.innerHTML="Branch: <strong>"+r(a.gitBranch)+"</strong>":d&&d.remove();const p=document.getElementById("node-block");if(p&&(null==(e=a.environment)?void 0:e.node)){const e=(null==(i=a.environment.node.runtimeVersion)?void 0:i.replace(/^v/,""))||"unknown",n=a.environment.node.minRequiredMajor,t=void 0!==n?` Â· dependency engines require â‰¥${n}`:"";p.innerHTML=void 0!==n?`<br/>Node: run on ${r(e)}${t}<br/><span class="header-disclaimer">Derived from declared dependency engine ranges; does not guarantee runtime compatibility.</span>`:`<br/>Node: run on ${r(e)}`}const m=document.getElementById("formatted-date");if(m&&a.generatedAt)try{const e=new Date(a.generatedAt),n=new Intl.DateTimeFormat(void 0,{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e);m.textContent=n}catch{m.textContent=a.generatedAt}const v=document.getElementById("tool-errors");if(v&&a.toolErrors&&Object.keys(a.toolErrors).length>0){const e=Object.entries(a.toolErrors).map(([e,n])=>`<div><strong>${r(e)}:</strong> ${r(n)}</div>`).join("");v.innerHTML=`<strong>Some tools failed:</strong>${e}`}const h={search:document.getElementById("search"),direct:document.getElementById("direct-filter"),runtime:document.getElementById("runtime-filter"),sort:document.getElementById("sort-by"),sortDirection:document.getElementById("sort-direction"),hasVulns:document.getElementById("has-vulns"),unusedOnly:document.getElementById("unused-only"),themeSwitch:document.getElementById("theme-switch"),licenseToggle:document.getElementById("license-toggle"),licensePanel:document.getElementById("license-panel"),licensePermissive:document.getElementById("license-permissive"),licenseWeakCopyleft:document.getElementById("license-weak-copyleft"),licenseStrongCopyleft:document.getElementById("license-strong-copyleft"),licenseUnknown:document.getElementById("license-unknown"),licenseAll:document.getElementById("license-all"),licenseFriendly:document.getElementById("license-friendly")};let y=!0;function f(){const e=function(e){const n=h.sort.value,i=[...e];return"name"===n?i.sort((e,n)=>e.name.localeCompare(n.name)):"depth"===n?i.sort((e,n)=>e.depth-n.depth):"severity"===n?i.sort((e,n)=>t[s(n)]-t[s(e)]):"size"===n&&i.sort((e,n)=>{var t,s;return((null==(t=n.sizeFootprint)?void 0:t.installedSize)||0)-((null==(s=e.sizeFootprint)?void 0:s.installedSize)||0)}),y||i.reverse(),i}(function(){const e=(h.search.value||"").toLowerCase(),i=h.direct.value,r=h.runtime.value,o=h.hasVulns.checked,l=h.unusedOnly.checked,c=h.licensePermissive.checked,d=h.licenseWeakCopyleft.checked,u=h.licenseStrongCopyleft.checked,p=h.licenseUnknown.checked;return a.dependencies.filter(a=>{if(e&&!a.name.toLowerCase().includes(e)&&!(a.license.license||"").toLowerCase().includes(e))return!1;if("direct"===i&&!a.direct)return!1;if("transitive"===i&&a.direct)return!1;if("all"!==r&&a.runtimeClass!==r)return!1;if(o&&0===t[s(a)])return!1;if(l&&"not-imported"!==a.usage.status)return!1;const m=n(a.license.license);return!("permissive"===m&&!c||"weakCopyleft"===m&&!d||"strongCopyleft"===m&&!u||"unknown"===m&&!p)})}());l.innerHTML="Showing <strong>"+e.length+"</strong> of <strong>"+a.dependencies.length+"</strong> dependencies",0!==e.length?o.innerHTML=e.map(g).join(""):o.innerHTML='<div class="empty-state"><div class="empty-state-icon">ðŸ“¦</div><div class="empty-state-text">No dependencies match your filters</div></div>'}"light"===localStorage.getItem("dependency-radar-theme")&&(document.documentElement.classList.add("light"),h.themeSwitch.classList.add("light")),h.themeSwitch.addEventListener("click",()=>{document.documentElement.classList.toggle("light"),h.themeSwitch.classList.toggle("light");const e=document.documentElement.classList.contains("light");localStorage.setItem("dependency-radar-theme",e?"light":"dark")}),h.licenseToggle.addEventListener("click",()=>{h.licenseToggle.classList.toggle("open"),h.licensePanel.classList.toggle("open")}),h.sortDirection.addEventListener("click",()=>{y=!y,h.sortDirection.textContent=y?"â†‘":"â†“",f()}),h.licenseAll.addEventListener("click",()=>{h.licensePermissive.checked=!0,h.licenseWeakCopyleft.checked=!0,h.licenseStrongCopyleft.checked=!0,h.licenseUnknown.checked=!0,f()}),h.licenseFriendly.addEventListener("click",()=>{h.licensePermissive.checked=!0,h.licenseWeakCopyleft.checked=!1,h.licenseStrongCopyleft.checked=!1,h.licenseUnknown.checked=!1,f()});[h.search,h.direct,h.runtime,h.sort,h.hasVulns,h.unusedOnly,h.licensePermissive,h.licenseWeakCopyleft,h.licenseStrongCopyleft,h.licenseUnknown].forEach(e=>{e&&(e.addEventListener("input",f),e.addEventListener("change",f))}),f()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",v):v()}();
