!function(){"use strict";const e={permissive:["MIT","ISC","BSD-2-Clause","BSD-3-Clause","Apache-2.0","Unlicense","0BSD","CC0-1.0","BSD","Apache","Apache 2.0","Apache License 2.0","MIT License","ISC License"],weakCopyleft:["LGPL-2.1","LGPL-3.0","LGPL-2.0","LGPL","MPL-2.0","MPL-1.1","MPL","EPL-1.0","EPL-2.0","EPL"],strongCopyleft:["GPL-2.0","GPL-3.0","GPL","AGPL-3.0","AGPL","GPL-2.0-only","GPL-3.0-only","GPL-2.0-or-later","GPL-3.0-or-later"]};function n(n){if(!n)return"unknown";const t=n.toUpperCase();for(const[s,i]of Object.entries(e))if(i.some(e=>t.includes(e.toUpperCase())))return s;return"unknown"}const t={none:0,low:1,moderate:2,high:3,critical:4};function s(e){var n;return(null==(n=e.vulnerabilities)?void 0:n.highest)||"none"}function i(e){return e?"Yes":"No"}function c(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""}function a(e){return"runtime"===e?"Runtime":"dev"===e?"Dev":"optional"===e?"Optional":"peer"===e?"Peer":e}function l(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function r(e,n,t){return'<div class="badge-card '+t+'"><span class="badge-label">'+c(e)+'</span><span class="badge-value">'+c(n)+"</span></div>"}function o(e,n,t){let s='<div class="kv-item">';return s+='<span class="kv-label">'+c(e)+"</span>",s+='<span class="kv-value">'+c(String(n))+"</span>",t&&(s+='<span class="kv-hint">'+c(t)+"</span>"),s+="</div>",s}function d(e,n){if(!e||0===e.length)return'<span class="kv-value">None</span>';const t=e.slice(0,n),s=e.length-n;let i='<div class="package-list">';return t.forEach(e=>{i+='<span class="package-tag">'+c(e)+"</span>"}),s>0&&(i+='<span class="package-tag">+'+s+" more</span>"),i+="</div>",i}function p(e,n,t){let s='<div class="section">';return s+='<div class="section-header">',s+='<span class="section-title">'+c(e)+"</span>",n&&(s+='<span class="section-desc">'+c(n)+"</span>"),s+="</div>",s+=t,s+="</div>",s}function u(e,n,t){return p(e,n,'<div class="kv-grid">'+t.join("")+"</div>")}function m(e){let n='<div class="package-links">';return n+='<a href="'+c(e.npm)+'" target="_blank" rel="noopener" class="package-link"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M0 7.334v8h6.666v1.332H12v-1.332h12v-8H0zm6.666 6.664H5.334v-4H3.999v4H1.335V8.667h5.331v5.331zm4 0v1.336H8.001V8.667h5.334v5.332h-2.669v-.001zm12.001 0h-1.33v-4h-1.336v4h-1.335v-4h-1.33v4h-2.671V8.667h8.002v5.331zM10.665 10H12v2.667h-1.335V10z"/></svg>npm</a>',n+="</div>",n}function g(e){const t=e.license||"Unknown",g=n(t),v=function(e){const n=[e.vulnRisk,e.licenseRisk];return n.includes("red")?"red":n.includes("amber")?"amber":"green"}(e),h=s(e),y={permissive:{text:"Permissive",class:"green"},weakCopyleft:{text:"Weak Copyleft",class:"amber"},strongCopyleft:{text:"Strong Copyleft",class:"red"},unknown:{text:"Unknown",class:"gray"}},k=e.direct?"Dependency":"Sub-Dependency",f=e.direct?"green":"amber",L="runtime"===e.scope?"green":"dev"===e.scope||"optional"===e.scope?"amber":"gray",C=[r("Type",k,f),r("Scope",a(e.scope),L),r("License",t,y[g].class),r("Vulns",l(h),e.vulnRisk),r("Build","red"===e.build.risk?"High":"amber"===e.build.risk?"Medium":"Low",e.build.risk)],w=['<summary class="dep-summary">','<svg class="expand-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>','<span class="dep-name">'+c(e.name)+'<span class="dep-version">@'+c(e.version)+"</span></span>",'<div class="dep-indicators">',C.join(""),"</div>","</summary>"].join(""),E=JSON.stringify(e,null,2),b=['<div class="kv-item"><span class="kv-label">Root Packages</span><span class="kv-value">'+e.origins.rootPackageCount+"</span></div>",'<div class="kv-item"><span class="kv-label">Top Root Packages</span>'+d(e.origins.topRootPackages,8)+"</div>"];e.origins.workspaces&&e.origins.workspaces.length>0&&b.push('<div class="kv-item"><span class="kv-label">Workspaces</span>'+d(e.origins.workspaces,8)+"</div>");const I=u("Overview","Dependency position and scope",[o("Type",k,e.direct?"Listed in package.json":"Installed as a sub-dependency"),o("Scope",a(e.scope),"Scope inferred from root dependencies"),o("Depth",e.depth,"How deep this package is in the dependency tree")]),B=p("Origins","Direct roots for this dependency",'<div class="kv-grid">'+b.join("")+"</div>"),S=u("License","License information for this package",[o("License",t,"The declared license"),o("Category",y[g].text,"Business-friendliness classification")]),P=u("Vulnerabilities","npm audit summary",[o("Critical",e.vulnerabilities.critical),o("High",e.vulnerabilities.high),o("Moderate",e.vulnerabilities.moderate),o("Low",e.vulnerabilities.low),o("Highest",l(e.vulnerabilities.highest))]),D=u("Identity","Package metadata",[o("Deprecated",i(e.deprecated),"Whether the author has deprecated this package"),o("Node Engine",e.nodeEngine||"Any","Required Node.js version")]),T=u("Dependency Surface","What this package depends on",[o("Dependencies",e.dependencySurface.deps+" prod / "+e.dependencySurface.dev+" dev / "+e.dependencySurface.peer+" peer / "+e.dependencySurface.opt+" optional","")]),x=u("Build","Build complexity indicators",[o("Native Code",i(e.build.native),"Requires compilation"),o("Install Scripts",i(e.build.installScripts),"Runs code during install"),o("Risk",l(e.build.risk),"Combined build risk signal")]),j=u("TypeScript","Type definition support",[o("Types","bundled"===e.tsTypes?"Bundled":"definitelyTyped"===e.tsTypes?"DefinitelyTyped":"none"===e.tsTypes?"None":"Unknown","Types availability")]),G=u("Graph","Dependency graph summary",[o("Fan In",e.graph.fanIn),o("Fan Out",e.graph.fanOut)]);return['<details class="dep-card" data-risk="'+v+'">',w,'<div class="dep-details">',m(e.links),I,B,S,P,D,T,x,j,G,'<details class="raw-data-toggle"><summary>View raw data</summary><pre>'+c(E)+"</pre></details>","</div>","</details>"].join("")}async function v(){var e,i;const c=await async function(){const e=document.getElementById("radar-data");return e&&e.textContent&&"{}"!==e.textContent.trim()?JSON.parse(e.textContent):(await fetch("./sample-data.json")).json()}(),a=document.getElementById("dependency-list"),l=document.getElementById("results-summary"),r=document.getElementById("project-path");r&&(r.textContent=c.project.projectDir);const o=document.getElementById("git-branch-item"),d=document.getElementById("git-branch");(null==(e=c.git)?void 0:e.branch)&&c.git.branch&&o&&d&&(d.textContent=c.git.branch,o.style.display="");const p=document.getElementById("node-item"),u=document.getElementById("node-version"),m=document.getElementById("node-disclaimer");if(c.environment&&p&&u){const e=(null==(i=c.environment.runtimeVersion)?void 0:i.replace(/^v/,""))||"unknown",n=c.environment.minRequiredMajor;u.textContent=e+(n&&n>0?` (requires â‰¥${n})`:""),p.style.display="",n&&n>0&&m&&(m.textContent="Node requirement derived from dependency engine ranges.",m.style.display="")}const v=document.getElementById("formatted-date");if(v&&c.generatedAt)try{const e=new Date(c.generatedAt),n=new Intl.DateTimeFormat(void 0,{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e);v.textContent=n}catch{v.textContent=c.generatedAt}const h={search:document.getElementById("search"),direct:document.getElementById("direct-filter"),runtime:document.getElementById("runtime-filter"),sort:document.getElementById("sort-by"),sortDirection:document.getElementById("sort-direction"),hasVulns:document.getElementById("has-vulns"),themeSwitch:document.getElementById("theme-switch"),licenseToggle:document.getElementById("license-toggle"),licensePanel:document.getElementById("license-panel"),licensePermissive:document.getElementById("license-permissive"),licenseWeakCopyleft:document.getElementById("license-weak-copyleft"),licenseStrongCopyleft:document.getElementById("license-strong-copyleft"),licenseUnknown:document.getElementById("license-unknown"),licenseAll:document.getElementById("license-all"),licenseFriendly:document.getElementById("license-friendly")};let y=!0;"light"===localStorage.getItem("dependency-radar-theme")&&(document.documentElement.classList.add("light"),h.themeSwitch.classList.add("light")),h.themeSwitch.addEventListener("click",()=>{document.documentElement.classList.toggle("light"),h.themeSwitch.classList.toggle("light");const e=document.documentElement.classList.contains("light");localStorage.setItem("dependency-radar-theme",e?"light":"dark")}),h.licenseToggle.addEventListener("click",()=>{h.licenseToggle.classList.toggle("open"),h.licensePanel.classList.toggle("open")}),h.sortDirection.addEventListener("click",()=>{y=!y,h.sortDirection.textContent=y?"â†‘":"â†“",f()}),h.licenseAll.addEventListener("click",()=>{h.licensePermissive.checked=!0,h.licenseWeakCopyleft.checked=!0,h.licenseStrongCopyleft.checked=!0,h.licenseUnknown.checked=!0,f()}),h.licenseFriendly.addEventListener("click",()=>{h.licensePermissive.checked=!0,h.licenseWeakCopyleft.checked=!1,h.licenseStrongCopyleft.checked=!1,h.licenseUnknown.checked=!1,f()});const k=Object.values(c.dependencies||{});function f(){var e;const i=function(e){const n=h.sort.value,i=[...e];return"name"===n?i.sort((e,n)=>e.name.localeCompare(n.name)):"depth"===n?i.sort((e,n)=>e.depth-n.depth):"severity"===n&&i.sort((e,n)=>t[s(n)]-t[s(e)]),y||i.reverse(),i}(function(){const e=(h.search.value||"").toLowerCase(),i=h.direct.value,c=h.runtime.value,a=h.hasVulns.checked,l=h.licensePermissive.checked,r=h.licenseWeakCopyleft.checked,o=h.licenseStrongCopyleft.checked,d=h.licenseUnknown.checked;return k.filter(p=>{if(e&&!p.name.toLowerCase().includes(e)&&!p.license.toLowerCase().includes(e))return!1;if("direct"===i&&!p.direct)return!1;if("transitive"===i&&p.direct)return!1;if("all"!==c&&p.scope!==c)return!1;if(a&&0===t[s(p)])return!1;const u=n(p.license);return!("permissive"===u&&!l||"weakCopyleft"===u&&!r||"strongCopyleft"===u&&!o||"unknown"===u&&!d)})}()),r=(null==(e=c.summary)?void 0:e.dependencyCount)||k.length;l.innerHTML="Showing <strong>"+i.length+"</strong> of <strong>"+r+"</strong> dependencies",0!==i.length?a.innerHTML=i.map(g).join(""):a.innerHTML='<div class="empty-state"><div class="empty-state-icon">ðŸ“¦</div><div class="empty-state-text">No dependencies match your filters</div></div>'}[h.search,h.direct,h.runtime,h.sort,h.hasVulns,h.licensePermissive,h.licenseWeakCopyleft,h.licenseStrongCopyleft,h.licenseUnknown].forEach(e=>{e&&(e.addEventListener("input",f),e.addEventListener("change",f))}),f()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",v):v()}();
